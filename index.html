<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½åŸå¸‚çŸ¥è­˜æŒ‘æˆ°</title>
    <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            overflow: hidden;
            user-select: none;
        }

        .game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
        }

        .progress-bar {
            width: 250px;
            height: 25px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #00ccff);
            width: 0%;
            transition: width 0.5s ease;
        }

        .game-screen {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .intro-screen {
            background: linear-gradient(45deg, #1a1a2e, #16213e, #0f3460);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
            padding: 40px;
        }

        .intro-title {
            font-size: 3.5rem;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #00ff88, #00ccff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5)); }
            to { filter: drop-shadow(0 0 20px rgba(0, 204, 255, 0.8)); }
        }

        .data-visualization {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
            margin: 30px 0;
            backdrop-filter: blur(10px);
            max-width: 600px;
        }

        .stat-number {
            font-size: 5rem;
            font-weight: bold;
            color: #00ff88;
            margin: 15px 0;
        }

        .challenge-screen {
            background: linear-gradient(135deg, #fd79a8, #e84393);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px;
            color: white;
        }

        .challenge-question {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            text-align: center;
            backdrop-filter: blur(10px);
            max-width: 800px;
            width: 100%;
        }

        .challenge-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            width: 100%;
            max-width: 1000px;
        }

        .option {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            color: #2d3436;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .option:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        .option.correct {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            animation: correctPulse 0.8s ease;
        }

        .option.incorrect {
            background: linear-gradient(135deg, #e17055, #d63031);
            color: white;
            animation: shake 0.8s ease;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-15px); }
            75% { transform: translateX(15px); }
        }

        .btn {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            border: none;
            border-radius: 30px;
            padding: 20px 40px;
            font-size: 1.3rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 15px;
            font-weight: bold;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: 25px;
            padding: 50px;
            max-width: 600px;
            text-align: center;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .modal.active .modal-content {
            transform: scale(1);
        }

        .wisdom-level {
            font-size: 1.2rem;
            font-weight: bold;
            padding: 10px 20px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.2);
        }

        @media (max-width: 768px) {
            .challenge-options {
                grid-template-columns: 1fr;
            }
            
            .intro-title {
                font-size: 2.5rem;
            }
            
            .stat-number {
                font-size: 3.5rem;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
                padding: 20px;
            }
            
            .progress-bar {
                width: 200px;
            }
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- éŠæˆ²æ¨™é¡Œæ¬„ -->
        <div class="header">
            <div>
                <h2>ğŸ™ï¸ æ™ºèƒ½åŸå¸‚çŸ¥è­˜æŒ‘æˆ°</h2>
                <div>åŸºæ–¼å½±ç‰‡å…§å®¹çš„æ™ºèƒ½åŸå¸‚æ¸¬é©—</div>
                <div id="studentDisplay" style="display: none; margin-top: 5px; font-size: 0.9rem; opacity: 0.8;">
                    ğŸ‘¤ å­¸è™Ÿ: <span id="displayStudentId"></span>
                </div>
            </div>
            <div>
                <div>ğŸ§  åŸå¸‚æ™ºæ…§åˆ†æ•¸: <span id="wisdomScore">0</span>/1000</div>
                <div>ç­”å°é¡Œæ•¸: <span id="correctCount">0</span>/10</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
            <div class="wisdom-level" id="wisdomLevel">ğŸŒ± æ™ºèƒ½åŸå¸‚æ–°æ‰‹</div>
        </div>

        <!-- éŠæˆ²ä¸»ç•«é¢ -->
        <div class="game-screen">
            <!-- é–‹å§‹ç•«é¢ -->
            <div id="introScreen" class="intro-screen">
                <h1 class="intro-title">æ™ºèƒ½åŸå¸‚çŸ¥è­˜æŒ‘æˆ°</h1>
                <div class="data-visualization">
                    <h3>ğŸ¯ æ¸¬é©—èªªæ˜</h3>
                    <div class="stat-number">10</div>
                    <p style="font-size: 1.3rem;">é“åŸºæ–¼å½±ç‰‡å…§å®¹çš„æ™ºèƒ½åŸå¸‚çŸ¥è­˜é¡Œç›®</p>
                    <div style="display: flex; justify-content: space-around; margin-top: 30px; font-size: 1.1rem;">
                        <div>ğŸ“Š äººå£å¢é•·æ•¸æ“š</div>
                        <div>ğŸ›ï¸ åŸå¸‚è¦åŠƒç†å¿µ</div>
                        <div>ğŸ¤– æ™ºèƒ½æŠ€è¡“æ‡‰ç”¨</div>
                    </div>
                </div>
                
                <!-- å­¸è™Ÿè¼¸å…¥å€åŸŸ -->
                <div class="student-input-section">
                    <h3 style="margin-bottom: 20px;">ğŸ“ è«‹è¼¸å…¥æ‚¨çš„å­¸è™Ÿ</h3>
                    <input type="text" id="studentId" placeholder="è«‹è¼¸å…¥å­¸è™Ÿ" 
                           style="padding: 15px 25px; font-size: 1.2rem; border: none; border-radius: 15px; 
                                  width: 300px; text-align: center; margin-bottom: 20px; 
                                  background: rgba(255, 255, 255, 0.9); color: #2d3436;">
                    <div id="studentIdError" style="color: #ff6b6b; font-size: 1rem; margin-bottom: 10px; display: none;">
                        è«‹è¼¸å…¥æœ‰æ•ˆçš„å­¸è™Ÿ
                    </div>
                </div>
                
                <p style="font-size: 1.3rem; margin: 30px 0;">
                    æ¸¬è©¦æ‚¨å°æ™ºèƒ½åŸå¸‚å½±ç‰‡å…§å®¹çš„ç†è§£ç¨‹åº¦ï¼
                </p>
                <button class="btn" onclick="startChallenge()">ğŸš€ é–‹å§‹æŒ‘æˆ°</button>
            </div>

            <!-- æŒ‘æˆ°éšæ®µ -->
            <div id="challengeScreen" class="challenge-screen hidden">
                <div class="challenge-question">
                    <div style="font-size: 4rem; margin-bottom: 20px;" id="questionIcon">ğŸ¯</div>
                    <h2 id="questionTitle" style="font-size: 1.8rem; margin-bottom: 15px;">æŒ‘æˆ°é¡Œç›®</h2>
                    <p id="questionText" style="font-size: 1.3rem; line-height: 1.6;">å•é¡Œæè¿°</p>
                    <div style="margin-top: 20px; font-size: 1.1rem;">
                        é¡Œç›® <span id="questionNumber">1</span>/10 | 
                        åˆ†æ•¸: <span id="score">0</span>/1000 | 
                        ç­”å°: <span id="currentCorrect">0</span>/10
                    </div>
                </div>
                <div class="challenge-options" id="challengeOptions">
                    <!-- é¸é …å°‡å‹•æ…‹ç”Ÿæˆ -->
                </div>
                <button class="btn hidden" id="nextQuestionBtn" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ â¡ï¸</button>
                <button class="btn hidden" id="finishBtn" onclick="finishGame()">æŸ¥çœ‹çµæœ ğŸ†</button>
            </div>
        </div>

        <!-- æ¨¡æ…‹æ¡† -->
        <div class="modal" id="modal">
            <div class="modal-content">
                <h3 id="modalTitle" style="font-size: 2rem; margin-bottom: 20px;">æ¨™é¡Œ</h3>
                <p id="modalText" style="font-size: 1.2rem; line-height: 1.6;">å…§å®¹</p>
                <button class="btn" onclick="closeModal()">ç¢ºå®š</button>
            </div>
        </div>
    </div>

    <script>
        // éŠæˆ²ç‹€æ…‹
        let gameState = {
            phase: 'intro', // intro, challenge
            currentQuestion: 0,
            score: 0,
            wisdomScore: 0,
            correctAnswers: 0,
            studentId: ''
        };

        // æŒ‘æˆ°é¡Œç›® - åŸºæ–¼å½±ç‰‡å…§å®¹çš„10é“é¡Œç›®
        const challenges = [
            {
                question: 'å½±ç‰‡ä»¥å“ªä¸€æ•¸æ“šä½œç‚ºåˆ‡å…¥é»ï¼Œå¼·èª¿äººå£æ¿€å¢çš„å½±éŸ¿ï¼Ÿ',
                icon: 'ğŸ“Š',
                options: [
                    { text: 'è³‡æºéœ€æ±‚å¢é•·100%', icon: 'ğŸ“ˆ', correct: false, explanation: 'æ•¸æ“šä¸æ­£ç¢ºï¼Œå¯¦éš›å¢é•·å¹…åº¦æ›´å¤§' },
                    { text: 'è³‡æºéœ€æ±‚å¢é•·518%', icon: 'ğŸš€', correct: true, explanation: 'æ­£ç¢ºï¼å½±ç‰‡å¼·èª¿äººå£æ¿€å¢å°è‡´è³‡æºéœ€æ±‚å¢é•·518%' },
                    { text: 'è³‡æºéœ€æ±‚å¢é•·200%', icon: 'ğŸ“Š', correct: false, explanation: 'æ•¸æ“šåä½ï¼Œå¯¦éš›å¢é•·æ›´ç‚ºé©šäºº' },
                    { text: 'è³‡æºéœ€æ±‚å¢é•·300%', icon: 'ğŸ“‰', correct: false, explanation: 'ä»ç„¶ä½ä¼°äº†å¯¦éš›çš„å¢é•·å¹…åº¦' }
                ]
            },
            {
                question: 'å½±ç‰‡ä¸­æåˆ°çš„å‚³çµ±åŸå¸‚è¦åŠƒç†å¿µç™¼æºåœ°æ˜¯å“ªè£¡ï¼Ÿ',
                icon: 'ğŸ›ï¸',
                options: [
                    { text: 'å€«æ•¦', icon: 'ğŸ‡¬ğŸ‡§', correct: false, explanation: 'å€«æ•¦æœ‰æ™ºèƒ½åƒåœ¾ç³»çµ±ï¼Œä½†ä¸æ˜¯ç”°åœ’åŸå¸‚ç™¼æºåœ°' },
                    { text: 'ä¸Šæµ·', icon: 'ğŸ‡¨ğŸ‡³', correct: false, explanation: 'ä¸Šæµ·ä»¥æ™ºèƒ½åœ°éµèåï¼Œéç”°åœ’åŸå¸‚èµ·æº' },
                    { text: 'è‹±åœ‹èŠå¥‡æ²ƒæ€', icon: 'ğŸŒ³', correct: true, explanation: 'æ­£ç¢ºï¼èŠå¥‡æ²ƒæ€æ˜¯ç”°åœ’åŸå¸‚ç†å¿µçš„ç™¼æºåœ°' },
                    { text: 'æ–°åŠ å¡', icon: 'ğŸ‡¸ğŸ‡¬', correct: false, explanation: 'æ–°åŠ å¡ä»¥æ•¸ä½å­¿ç”ŸæŠ€è¡“è‘—ç¨±' }
                ]
            },
            {
                question: 'æ¨å‹•æ™ºèƒ½åŸå¸‚ç™¼å±•çš„æ ¸å¿ƒæŠ€è¡“ä¸åŒ…æ‹¬ä¸‹åˆ—å“ªä¸€é …ï¼Ÿ',
                icon: 'ğŸ¤–',
                options: [
                    { text: 'äººå·¥æ™ºæ…§', icon: 'ğŸ§ ', correct: false, explanation: 'AIæ˜¯æ™ºèƒ½åŸå¸‚çš„æ ¸å¿ƒæŠ€è¡“ä¹‹ä¸€' },
                    { text: 'å¤§æ•¸æ“š', icon: 'ğŸ“Š', correct: false, explanation: 'å¤§æ•¸æ“šæ˜¯æ™ºèƒ½åŸå¸‚çš„é‡è¦æ”¯æ’' },
                    { text: '5Gé€šä¿¡', icon: 'ğŸ“¡', correct: false, explanation: '5Gæä¾›é«˜é€Ÿä½å»¶é²çš„é€šä¿¡åŸºç¤' },
                    { text: 'å‚³çµ±é›»è©±ç·š', icon: 'â˜ï¸', correct: true, explanation: 'æ­£ç¢ºï¼å‚³çµ±é›»è©±ç·šä¸æ˜¯æ™ºèƒ½åŸå¸‚çš„æ ¸å¿ƒæŠ€è¡“' }
                ]
            },
            {
                question: 'å€«æ•¦çš„æ™ºèƒ½åƒåœ¾è™•ç†ç³»çµ±åç¨±æ˜¯ä»€éº¼ï¼Ÿ',
                icon: 'ğŸ—‘ï¸',
                options: [
                    { text: 'å›æ”¶ä¹‹çœ¼ï¼ˆRecycleyeï¼‰', icon: 'ğŸ‘ï¸', correct: true, explanation: 'æ­£ç¢ºï¼å›æ”¶ä¹‹çœ¼æ˜¯å€«æ•¦çš„AIåƒåœ¾åˆ†é¡ç³»çµ±' },
                    { text: 'åƒåœ¾æ©Ÿå™¨äºº', icon: 'ğŸ¤–', correct: false, explanation: 'é€™ä¸æ˜¯å€«æ•¦ç³»çµ±çš„æ­£ç¢ºåç¨±' },
                    { text: 'ç’°å¢ƒè¡›å£«', icon: 'ğŸ›¡ï¸', correct: false, explanation: 'åç¨±ä¸æ­£ç¢º' },
                    { text: 'åŸå¸‚æ¸…æ½”è€…', icon: 'ğŸ§¹', correct: false, explanation: 'é€™ä¸æ˜¯è©²ç³»çµ±çš„åç¨±' }
                ]
            },
            {
                question: 'å·´è¥¿åº«é‡Œæå·´çš„å¿«é€Ÿå…¬äº¤ç³»çµ±ï¼ˆBRTï¼‰çš„ä¸»è¦å‰µæ–°æ˜¯ä»€éº¼ï¼Ÿ',
                icon: 'ğŸšŒ',
                options: [
                    { text: 'ç„¡äººé§•é§›', icon: 'ğŸ¤–', correct: false, explanation: 'BRTçš„å‰µæ–°ä¸åœ¨æ–¼ç„¡äººé§•é§›' },
                    { text: 'å°ˆç”¨è»Šé“å’Œç®¡ç­’å¼è»Šç«™', icon: 'ğŸš‡', correct: true, explanation: 'æ­£ç¢ºï¼BRTçš„å‰µæ–°åœ¨æ–¼å°ˆç”¨è»Šé“å’Œç¨ç‰¹çš„ç®¡ç­’å¼è»Šç«™è¨­è¨ˆ' },
                    { text: 'è™›æ“¬æ¨¡æ“¬', icon: 'ğŸ’»', correct: false, explanation: 'é€™ä¸æ˜¯BRTç³»çµ±çš„ä¸»è¦ç‰¹é»' },
                    { text: 'å¤§æ•¸æ“šç›£æ¸¬', icon: 'ğŸ“Š', correct: false, explanation: 'å¤§æ•¸æ“šä¸æ˜¯BRTçš„æ ¸å¿ƒå‰µæ–°' }
                ]
            },
            {
                question: 'ä¸Šæµ·åœ°éµ10è™Ÿç·šçš„ç‰¹é»æ˜¯ä»€éº¼ï¼Ÿ',
                icon: 'ğŸš‡',
                options: [
                    { text: 'å®Œå…¨ç„¡äººé§•é§›', icon: 'ğŸ¤–', correct: true, explanation: 'æ­£ç¢ºï¼ä¸Šæµ·åœ°éµ10è™Ÿç·šå¯¦ç¾äº†å®Œå…¨ç„¡äººé§•é§›' },
                    { text: 'ç™¾ç±³æŸµæ ¼ç›£æ¸¬', icon: 'ğŸ“Š', correct: false, explanation: 'ç™¾ç±³æŸµæ ¼æ˜¯åŒ—äº¬çš„åŸå¸‚ç®¡ç†ç‰¹è‰²' },
                    { text: 'æ•¸ä½å­¿ç”Ÿæ¨¡å‹', icon: 'ğŸ’»', correct: false, explanation: 'æ•¸ä½å­¿ç”Ÿæ˜¯æ–°åŠ å¡çš„ç‰¹è‰²æŠ€è¡“' },
                    { text: 'é ç¨‹é†«ç™‚æ‡‰ç”¨', icon: 'ğŸ¥', correct: false, explanation: 'é€™ä¸æ˜¯åœ°éµç³»çµ±çš„ç‰¹é»' }
                ]
            },
            {
                question: 'æ–°åŠ å¡çš„ã€Œè™›æ“¬æ–°åŠ å¡ã€é …ç›®ä¸»è¦æ‡‰ç”¨å“ªä¸€æŠ€è¡“ï¼Ÿ',
                icon: 'ğŸ™ï¸',
                options: [
                    { text: '5G', icon: 'ğŸ“¡', correct: false, explanation: '5Gæ˜¯é€šä¿¡æŠ€è¡“ï¼Œä¸æ˜¯è™›æ“¬æ–°åŠ å¡çš„æ ¸å¿ƒ' },
                    { text: 'æ•¸ä½å­¿ç”Ÿ', icon: 'ğŸ‘¥', correct: true, explanation: 'æ­£ç¢ºï¼è™›æ“¬æ–°åŠ å¡é …ç›®ä¸»è¦æ‡‰ç”¨æ•¸ä½å­¿ç”ŸæŠ€è¡“' },
                    { text: 'äººå·¥æ™ºæ…§è¦–è¦º', icon: 'ğŸ‘ï¸', correct: false, explanation: 'AIè¦–è¦ºä¸æ˜¯è©²é …ç›®çš„ä¸»è¦æŠ€è¡“' },
                    { text: 'æ··åˆç¾å¯¦', icon: 'ğŸ¥½', correct: false, explanation: 'MRä¸æ˜¯è™›æ“¬æ–°åŠ å¡çš„æ ¸å¿ƒæŠ€è¡“' }
                ]
            },
            {
                question: 'åŒ—äº¬çš„åŸå¸‚ç®¡ç†ä½¿ç”¨å¤§æ•¸æ“šå°‡åŸå¸‚åŠƒåˆ†ç‚ºä»€éº¼ï¼Ÿ',
                icon: 'ğŸ¢',
                options: [
                    { text: 'åƒç±³å€åŸŸ', icon: 'ğŸ“', correct: false, explanation: 'åŠƒåˆ†å–®ä½å¤ªå¤§ï¼Œä¸å¤ ç²¾ç´°' },
                    { text: 'ç™¾ç±³æŸµæ ¼', icon: 'ğŸ”²', correct: true, explanation: 'æ­£ç¢ºï¼åŒ—äº¬ä½¿ç”¨ç™¾ç±³æŸµæ ¼é€²è¡Œç²¾ç´°åŒ–åŸå¸‚ç®¡ç†' },
                    { text: 'å…¬é‡Œç¶²æ ¼', icon: 'ğŸ—ºï¸', correct: false, explanation: 'å–®ä½å¤ªå¤§ï¼Œç„¡æ³•å¯¦ç¾ç²¾ç´°ç®¡ç†' },
                    { text: 'è¡Œæ”¿å€å¡Š', icon: 'ğŸ›ï¸', correct: false, explanation: 'è¡Œæ”¿å€å¡Šä¸æ˜¯å¤§æ•¸æ“šåŠƒåˆ†æ–¹å¼' }
                ]
            },
            {
                question: 'å½±ç‰‡ä¸­ï¼Œ5Gå’Œæ··åˆç¾å¯¦æŠ€è¡“ä¸»è¦æ‡‰ç”¨åœ¨å“ªä¸€é ˜åŸŸä¾†ç¸®å°åŸé„‰å·®è·ï¼Ÿ',
                icon: 'ğŸ¥',
                options: [
                    { text: 'äº¤é€šè¦åŠƒ', icon: 'ğŸš¦', correct: false, explanation: 'äº¤é€šè¦åŠƒä¸æ˜¯5G+MRçš„ä¸»è¦æ‡‰ç”¨é ˜åŸŸ' },
                    { text: 'åƒåœ¾è™•ç†', icon: 'ğŸ—‘ï¸', correct: false, explanation: 'åƒåœ¾è™•ç†ä¸»è¦ä½¿ç”¨AIæŠ€è¡“' },
                    { text: 'é ç¨‹é†«ç™‚', icon: 'ğŸ‘¨â€âš•ï¸', correct: true, explanation: 'æ­£ç¢ºï¼5G+MRæŠ€è¡“åœ¨é ç¨‹é†«ç™‚é ˜åŸŸç¸®å°åŸé„‰å·®è·' },
                    { text: 'åŸå¸‚æ¨¡æ“¬', icon: 'ğŸ™ï¸', correct: false, explanation: 'åŸå¸‚æ¨¡æ“¬ä¸»è¦ä½¿ç”¨æ•¸ä½å­¿ç”ŸæŠ€è¡“' }
                ]
            },
            {
                question: 'å½±ç‰‡çµè«–å¼·èª¿æ™ºèƒ½åŸå¸‚çš„å»ºè¨­éœ€è¦ä»€éº¼å¹³è¡¡ï¼Ÿ',
                icon: 'âš–ï¸',
                options: [
                    { text: 'æŠ€è¡“å‰µæ–°èˆ‡äººæ–‡é—œæ‡·', icon: 'ğŸ¤', correct: true, explanation: 'æ­£ç¢ºï¼æ™ºèƒ½åŸå¸‚éœ€è¦å¹³è¡¡æŠ€è¡“å‰µæ–°èˆ‡äººæ–‡é—œæ‡·' },
                    { text: 'å‚³çµ±æ¨¡å¼èˆ‡ç¾ä»£æ¨¡å¼', icon: 'ğŸ”„', correct: false, explanation: 'é€™ä¸æ˜¯å½±ç‰‡å¼·èª¿çš„ä¸»è¦å¹³è¡¡é»' },
                    { text: 'æ­æ´²æ¡ˆä¾‹èˆ‡äºæ´²æ¡ˆä¾‹', icon: 'ğŸŒ', correct: false, explanation: 'åœ°å€æ¡ˆä¾‹ä¸æ˜¯ä¸»è¦çš„å¹³è¡¡è€ƒé‡' },
                    { text: 'å–®ä¸€æŠ€è¡“èˆ‡å¤šç¨®æŠ€è¡“', icon: 'ğŸ”§', correct: false, explanation: 'æŠ€è¡“å¤šæ¨£æ€§ä¸æ˜¯æ ¸å¿ƒå¹³è¡¡é»' }
                ]
            }
        ];

        // åˆå§‹åŒ–éŠæˆ²
        function initGame() {
            updateUI();
            document.getElementById('studentId').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startChallenge();
                }
            });
        }

        // é–‹å§‹æŒ‘æˆ°éšæ®µ
        function startChallenge() {
            const studentIdInput = document.getElementById('studentId');
            const studentId = studentIdInput.value.trim();
            const errorDiv = document.getElementById('studentIdError');
            
            if (!studentId) {
                errorDiv.textContent = 'è«‹è¼¸å…¥å­¸è™Ÿ';
                errorDiv.style.display = 'block';
                studentIdInput.focus();
                return;
            }
            
            if (studentId.length < 3) {
                errorDiv.textContent = 'å­¸è™Ÿé•·åº¦è‡³å°‘éœ€è¦3å€‹å­—ç¬¦';
                errorDiv.style.display = 'block';
                studentIdInput.focus();
                return;
            }
            
            gameState.studentId = studentId;
            errorDiv.style.display = 'none';
            document.getElementById('displayStudentId').textContent = studentId;
            document.getElementById('studentDisplay').style.display = 'block';
            
            gameState.phase = 'challenge';
            gameState.currentQuestion = 0;
            gameState.score = 0;
            gameState.correctAnswers = 0;
            gameState.wisdomScore = 0;
            
            document.getElementById('introScreen').classList.add('hidden');
            document.getElementById('challengeScreen').classList.remove('hidden');
            
            loadQuestion();
            playSound('challenge');
        }

        // è¼‰å…¥é¡Œç›®
        function loadQuestion() {
            const question = challenges[gameState.currentQuestion];
            document.getElementById('questionIcon').textContent = question.icon;
            document.getElementById('questionTitle').textContent = `ç¬¬ ${gameState.currentQuestion + 1} é¡Œ`;
            document.getElementById('questionText').textContent = question.question;
            document.getElementById('questionNumber').textContent = gameState.currentQuestion + 1;
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('currentCorrect').textContent = gameState.correctAnswers;

            const optionsContainer = document.getElementById('challengeOptions');
            optionsContainer.innerHTML = '';

            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.innerHTML = `
                    <div style="font-size: 3rem; margin-bottom: 15px;">
                        ${option.icon}
                    </div>
                    <div style="font-weight: bold; font-size: 1.2rem; line-height: 1.4;">${option.text}</div>
                `;
                optionElement.onclick = () => selectOption(index);
                optionsContainer.appendChild(optionElement);
            });

            document.getElementById('nextQuestionBtn').classList.add('hidden');
            document.getElementById('finishBtn').classList.add('hidden');
        }

        // é¸æ“‡ç­”æ¡ˆ
        function selectOption(selectedIndex) {
            const question = challenges[gameState.currentQuestion];
            const options = document.querySelectorAll('.option');
            
            options.forEach(option => option.style.pointerEvents = 'none');

            if (question.options[selectedIndex].correct) {
                options[selectedIndex].classList.add('correct');
                gameState.score += 100;
                gameState.wisdomScore += 100;
                gameState.correctAnswers += 1;
                playSound('correct');
                showModal('ğŸ‰ æ­£ç¢ºï¼', question.options[selectedIndex].explanation);
            } else {
                options[selectedIndex].classList.add('incorrect');
                question.options.forEach((option, index) => {
                    if (option.correct) {
                        options[index].classList.add('correct');
                    }
                });
                playSound('incorrect');
                showModal('âŒ ç­”éŒ¯äº†', question.options[selectedIndex].explanation + '\n\n' + 
                    'æ­£ç¢ºç­”æ¡ˆï¼š' + question.options.find(o => o.correct).text);
            }

            updateUI();

            setTimeout(() => {
                if (gameState.currentQuestion < challenges.length - 1) {
                    document.getElementById('nextQuestionBtn').classList.remove('hidden');
                } else {
                    document.getElementById('finishBtn').classList.remove('hidden');
                }
            }, 2500);
        }

        // ä¸‹ä¸€é¡Œ
        function nextQuestion() {
            gameState.currentQuestion++;
            loadQuestion();
        }

        // å®ŒæˆéŠæˆ²
        function finishGame() {
            let message = '';
            let title = '';
            let wisdomLevel = '';
            
            if (gameState.wisdomScore >= 900) {
                wisdomLevel = 'ğŸ† æ™ºèƒ½åŸå¸‚å¤§å¸«';
            } else if (gameState.wisdomScore >= 800) {
                wisdomLevel = 'ğŸ¥‡ æ™ºèƒ½åŸå¸‚å°ˆå®¶';
            } else if (gameState.wisdomScore >= 600) {
                wisdomLevel = 'ğŸ¥ˆ æ™ºèƒ½åŸå¸‚å­¸è€…';
            } else if (gameState.wisdomScore >= 400) {
                wisdomLevel = 'ğŸ¥‰ æ™ºèƒ½åŸå¸‚æ¢ç´¢è€…';
            } else {
                wisdomLevel = 'ğŸŒ± æ™ºèƒ½åŸå¸‚æ–°æ‰‹';
            }
            
            const accuracy = Math.round((gameState.correctAnswers / 10) * 100);
            
            if (gameState.correctAnswers >= 9) {
                title = 'ğŸ† å®Œç¾è¡¨ç¾ï¼';
                message = `å­¸è™Ÿï¼š${gameState.studentId}\n${wisdomLevel}\n\nç­”å°é¡Œæ•¸ï¼š${gameState.correctAnswers}/10 (${accuracy}%)\næœ€çµ‚åˆ†æ•¸ï¼š${gameState.score}/1000\n\næ‚¨å®Œå…¨æŒæ¡äº†æ™ºèƒ½åŸå¸‚çš„æ ¸å¿ƒçŸ¥è­˜ï¼Œæ˜¯çœŸæ­£çš„æ™ºèƒ½åŸå¸‚å°ˆå®¶ï¼`;
            } else if (gameState.correctAnswers >= 7) {
                title = 'ğŸ‰ å„ªç§€è¡¨ç¾ï¼';
                message = `å­¸è™Ÿï¼š${gameState.studentId}\n${wisdomLevel}\n\nç­”å°é¡Œæ•¸ï¼š${gameState.correctAnswers}/10 (${accuracy}%)\næœ€çµ‚åˆ†æ•¸ï¼š${gameState.score}/1000\n\næ‚¨å°æ™ºèƒ½åŸå¸‚æœ‰å¾ˆå¥½çš„ç†è§£ï¼Œç¹¼çºŒä¿æŒå­¸ç¿’ç†±å¿±ï¼`;
            } else if (gameState.correctAnswers >= 5) {
                title = 'ğŸ‘ ä¸éŒ¯çš„é–‹å§‹ï¼';
                message = `å­¸è™Ÿï¼š${gameState.studentId}\n${wisdomLevel}\n\nç­”å°é¡Œæ•¸ï¼š${gameState.correctAnswers}/10 (${accuracy}%)\næœ€çµ‚åˆ†æ•¸ï¼š${gameState.score}/1000\n\næ‚¨å·²ç¶“æŒæ¡äº†åŸºæœ¬çš„æ™ºèƒ½åŸå¸‚æ¦‚å¿µï¼Œå¯ä»¥é€²ä¸€æ­¥æ·±å…¥å­¸ç¿’ï¼`;
            } else {
                title = 'ğŸ’ª ç¹¼çºŒå­¸ç¿’ï¼';
                message = `å­¸è™Ÿï¼š${gameState.studentId}\n${wisdomLevel}\n\nç­”å°é¡Œæ•¸ï¼š${gameState.correctAnswers}/10 (${accuracy}%)\næœ€çµ‚åˆ†æ•¸ï¼š${gameState.score}/1000\n\nå»ºè­°é‡æ–°è§€çœ‹å½±ç‰‡ä¸¦å†æ¬¡æŒ‘æˆ°ï¼ŒåŠ æ·±å°æ™ºèƒ½åŸå¸‚çš„ç†è§£ï¼`;
            }
            
            showModal(title, message);
            playSound('finish');
            
            // ç™¼é€æ•¸æ“šåˆ° Google è©¦ç®—è¡¨
            sendToGoogleSheet(accuracy, wisdomLevel);
        }

        // ç™¼é€æ•¸æ“šåˆ° Google Apps Script
        function sendToGoogleSheet(accuracy, wisdomLevel) {
            const webAppUrl = 'https://script.google.com/macros/s/AKfycbxFBHv0Hg9iEg9GKrsjRK6n8oHU_wcaV3w_DfxR576KkB-WnHTNZ15mwKjtvYpNvTkThA/exec';  // æ›¿æ›ç‚ºä½ çš„ Apps Script Web App URL
            const data = {
                studentId: gameState.studentId,
                correctAnswers: gameState.correctAnswers + '/10',
                totalScore: gameState.score + '/1000',
                accuracy: accuracy + '%',
                wisdomLevel: wisdomLevel
            };

            fetch(webAppUrl, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: new URLSearchParams(data)
            })
            .then(() => {
                console.log('æ•¸æ“šå·²ç™¼é€åˆ°è©¦ç®—è¡¨ï¼');
                // å¯é¸ï¼šé¡¯ç¤ºæˆåŠŸæç¤º
                // alert('æˆç¸¾å·²æˆåŠŸè¨˜éŒ„åˆ°è©¦ç®—è¡¨ï¼');
            })
            .catch(error => {
                console.error('ç™¼é€å¤±æ•—ï¼š', error);
                // å¯é¸ï¼šé¡¯ç¤ºéŒ¯èª¤æç¤º
                // alert('ç„¡æ³•è¨˜éŒ„æˆç¸¾ï¼Œè«‹æª¢æŸ¥ç¶²è·¯æˆ–ä¼ºæœå™¨è¨­å®šã€‚');
            });
        }

        // æ›´æ–° UI
        function updateUI() {
            document.getElementById('correctCount').textContent = gameState.correctAnswers;
            document.getElementById('wisdomScore').textContent = gameState.wisdomScore;
            document.getElementById('score').textContent = gameState.score;
            
            const progress = (gameState.currentQuestion / 10) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            let wisdomLevel = '';
            if (gameState.wisdomScore >= 900) {
                wisdomLevel = 'ğŸ† æ™ºèƒ½åŸå¸‚å¤§å¸«';
            } else if (gameState.wisdomScore >= 800) {
                wisdomLevel = 'ğŸ¥‡ æ™ºèƒ½åŸå¸‚å°ˆå®¶';
            } else if (gameState.wisdomScore >= 600) {
                wisdomLevel = 'ğŸ¥ˆ æ™ºèƒ½åŸå¸‚å­¸è€…';
            } else if (gameState.wisdomScore >= 400) {
                wisdomLevel = 'ğŸ¥‰ æ™ºèƒ½åŸå¸‚æ¢ç´¢è€…';
            } else {
                wisdomLevel = 'ğŸŒ± æ™ºèƒ½åŸå¸‚æ–°æ‰‹';
            }
            document.getElementById('wisdomLevel').textContent = wisdomLevel;
            
            const progressFill = document.getElementById('progressFill');
            if (gameState.wisdomScore >= 800) {
                progressFill.style.background = 'linear-gradient(90deg, #00ff88, #00d4aa)';
            } else if (gameState.wisdomScore >= 500) {
                progressFill.style.background = 'linear-gradient(90deg, #74b9ff, #0984e3)';
            } else {
                progressFill.style.background = 'linear-gradient(90deg, #00ff88, #00ccff)';
            }
        }

        // é¡¯ç¤ºæ¨¡æ…‹æ¡†
        function showModal(title, text) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalText').textContent = text;
            document.getElementById('modal').classList.add('active');
        }

        // é—œé–‰æ¨¡æ…‹æ¡†
        function closeModal() {
            document.getElementById('modal').classList.remove('active');
        }

        // éŸ³æ•ˆæ’­æ”¾ï¼ˆæ¨¡æ“¬ï¼‰
        function playSound(type) {
            console.log(`æ’­æ”¾éŸ³æ•ˆ: ${type}`);
        }

        // åˆå§‹åŒ–éŠæˆ²
        initGame();
    </script>
</body>
</html>